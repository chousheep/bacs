library(data.table)
ac_bundles_dt <- fread("piccollage_accounts_bundles.csv")
ac_bundles_matrix <- as.matrix(ac_bundles_dt[, -1, with=FALSE])
rec_bundles_matrix <- ac_bundles_matrix[,c("yummyfood","peanutman", "food", "icecreamsocial", "bananaman")]
head(rec_bundles_matrix)
tail(rec_bundles_matrix)
library(lsa)
# Build auto_recommending function that takes bundles individually as the parameter
auto_recommend_by_cossim <- function(ac_bundles) {
cos_sim <- cosine(as.matrix(ac_bundles))
all_recommendations <- list()
for (bundle_index in 1:ncol(ac_bundles)) {
# Order by similarity in descending order, and exclude the first one (itself) and take the top 5
similar_bundles_indices <- order(cos_sim[bundle_index, ], decreasing = TRUE)[2:6]
# Get the names of the top 5 similar bundles
similar_bundles_names <- colnames(ac_bundles_matrix)[similar_bundles_indices]
all_recommendations[[colnames(ac_bundles)[bundle_index]]] <- similar_bundles_names
}
return(all_recommendations)
}
recommendations_by_cossim <- auto_recommend_by_cossim(ac_bundles_matrix)
recommendations_by_cossim[["kungfood"]]
mean_centered_matrix <- sweep(ac_bundles_matrix, 2, colMeans(ac_bundles_matrix), "-")
recommendations_by_corre <- auto_recommend_by_cossim(mean_centered_matrix)
recommendations_by_corre[["kungfood"]]
mean_centered_matrix <- sweep(ac_bundles_matrix, 1, rowMeans(ac_bundles_matrix), "-")
recommendations_by_adjcos <- auto_recommend_by_cossim(mean_centered_matrix)
recommendations_by_adjcos[["kungfood"]]
summary(lm(pts$y~pts$x))
graphics.off()
windows()
compstatslib::interactive_regression()
install.packages(compstatslib)
install.packages(("remotes")
\
install.packages("remotes")
remotes::install_github("soumyaray/compstatslib")
library(compstatslib)
library(compstatslib)
pts <- interactive_regression()
library(compstatslib)
pts <- interactive_regression()
pts <- interactive_regression()
pts <- interactive_regression()
# library(compstatslib)
# pts <- interactive_regression()
pts <- interactive_regression()
library(data.table)
ac_bundles_dt <- fread("piccollage_accounts_bundles.csv")
ac_bundles_matrix <- as.matrix(ac_bundles_dt[, -1, with=FALSE])
rec_bundles_matrix <- ac_bundles_matrix[,c("yummyfood","peanutman", "food", "icecreamsocial", "bananaman")]
head(rec_bundles_matrix)
tail(rec_bundles_matrix)
library(lsa)
# Build auto_recommending function that takes bundles individually as the parameter
auto_recommend_by_cossim <- function(ac_bundles) {
cos_sim <- cosine(as.matrix(ac_bundles))
all_recommendations <- list()
for (bundle_index in 1:ncol(ac_bundles)) {
# Order by similarity in descending order, and exclude the first one (itself) and take the top 5
similar_bundles_indices <- order(cos_sim[bundle_index, ], decreasing = TRUE)[2:6]
# Get the names of the top 5 similar bundles
similar_bundles_names <- colnames(ac_bundles_matrix)[similar_bundles_indices]
all_recommendations[[colnames(ac_bundles)[bundle_index]]] <- similar_bundles_names
}
return(all_recommendations)
}
recommendations_by_cossim <- auto_recommend_by_cossim(ac_bundles_matrix)
recommendations_by_cossim[["kungfood"]]
mean_centered_matrix <- sweep(ac_bundles_matrix, 2, colMeans(ac_bundles_matrix), "-")
recommendations_by_corre <- auto_recommend_by_cossim(mean_centered_matrix)
recommendations_by_corre[["kungfood"]]
mean_centered_matrix <- sweep(ac_bundles_matrix, 1, rowMeans(ac_bundles_matrix), "-")
recommendations_by_adjcos <- auto_recommend_by_cossim(mean_centered_matrix)
recommendations_by_adjcos[["kungfood"]]
# library(compstatslib)
# pts <- interactive_regression()
summary(lm(pts$y~pts$x))
cor(pts)
pts_standardized <- as.data.frame(scale(pts))
summary(lm(pts_standardized$y~pts_standardized$x))
# library(compstatslib)
pts <- interactive_regression()
pts <- interactive_regression()
pts
summary(lm(pts$y~pts$x))
knit_with_parameters("G:/我的雲端硬碟/ongoing_courses/bacs/hw7/bacs_hw7.Rmd")
knit_with_parameters("G:/我的雲端硬碟/ongoing_courses/bacs/hw7/bacs_hw7.Rmd")
# Perform on Console
pts <- interactive_regression()
pts
knit_with_parameters("G:/我的雲端硬碟/ongoing_courses/bacs/hw7/bacs_hw7.Rmd")
pts
pts
pts <- interactive_regression()
pts
# Perform on Console
# pts <- interactive_regression()
# Store the dataframe manually
pts <- data.frame(
x = c(-0.2945627, 4.2347352, 3.5379201, 1.9700862, 8.7640331, 19.4775647, 30.3653, 39.1625902, 45.8694352, 40.9046278,
21.5680099, 5.8025691, -3.9528418, -0.6429703, 26.5328172, 18.2581383, 15.2966743, 28.9716699, 23.5713532, 29.9297906,
34.5461904, 27.1425304, 36.1140243, 31.6718283, 40.5562203, 52.2278726, 44.7371107, 36.3753299, 29.3200774, 7.5446067,
19.9130741, 15.9063875, 11.812599, 12.6836178, 11.6383952, -0.2945627, -1.8623966, 22.96164, 22.8745381, 26.0973078,
29.7555868, 36.7237375, 44.7371107, 47.8727785, 43.1692768, 34.7203942, 30.1910963, 13.9030442, 2.14429, -6.9143058,
9.1124406, 24.6165758, 22.6132324, 3.7992258, 0.3151504, -1.7752947, -3.9528418, 11.2028858, 14.6869611, 19.1291571,
13.5546366, 5.0186521, 5.2799578, 19.5646665, 17.8226289, 17.1258138, 16.6903044),
y = c(0.8404706, 0.2108332, 1.3126987, 3.8312487, 11.2294891, 17.5258639, 29.488976, 36.8872165, 43.49841, 41.4520882,
24.4518762, 7.7664829, -1.6780793, -2.1503074, 16.8962264, 18.4703201, 13.9054484, 26.3407886, 23.8222387, 25.3963324,
35.6279415, 27.1278355, 34.2112572, 34.0538478, 32.3223447, 50.2670129, 43.9706381, 32.4797541, 24.4518762, 4.7757049,
16.1091796, 17.8406826, 9.0257579, 13.4332203, 17.6832733, 1.9423362, -5.7707229, 18.4703201, 18.9425482, 32.4797541,
24.6092856, 34.6834853, 45.2299131, 48.0632817, 34.0538478, 29.1741573, 23.3500106, 7.9238923, 6.9794361, 1.1552894,
13.9054484, 27.6000636, 21.1462794, 8.3961204, 6.9794361, 8.7109392, 3.2016112, 8.8683485, 10.4424422, 20.98887,
18.9425482, 6.1923892, 8.238711, 15.7943608, 15.007314, 12.6461734, 12.488764)
)
summary(lm(pts$y~pts$x))
cor(pts)
pts_standardized <- as.data.frame(scale(pts))
summary(lm(pts_standardized$y~pts_standardized$x))
