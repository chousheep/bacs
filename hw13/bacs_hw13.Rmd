---
title: "bacs_hw13"
author: '110071010'
date: "2024-05-18"
output:
  html_document:
    df_print: paged
  word_document: default
---

# Question 1

Composite Path Models using PLS-PM

## 1a

Create a PLS path model using SEMinR, with all the following characteristics:

```{r, results="hold"}
library(seminr)
sec <- read.csv("security_data_sem.csv")
#View(sec)
```

### i

Measurement model -- all constructs are measured as composites:

```{r, results="hold"}
sec_pls_mm <- constructs(
  composite("TRUST", multi_items("TRST",1:4)), # Trust in website (TRUST)
  composite("SEC", multi_items("PSEC",1:4)), # Perceived security of website (SEC)
  composite("REP", multi_items("PREP",1:4)), # Reputation of website (REP)
  composite("INV", multi_items("PINV",1:3)), # Investment in website (INV)
  composite("POL", multi_items("PPSS",1:3)), # Perception of privacy policies (POL)
  composite("FAML", single_item("FAML1")), # Familiarity with website (FAML)
  interaction_term(iv = "REP", moderator = "POL", method=orthogonal)
)
```

### ii

Structural Model -- paths between constructs as shown in this causal model:

```{r, results="hold"}
# REP + INV + POL + FAML + (REP✕POL) → SEC → TRUST
sec_pls_sm <- relationships(
  paths(from = c("REP","INV","POL","FAML","REP*POL"), to = "SEC"),
  paths(from = "SEC", to = "TRUST")
)
```

## 1b

Show us the following results in table or figure formats:

### i

Plot a figure of the estimated model

```{r, results="hold"}
sec_pls <- estimate_pls(data = sec,
                        measurement_model = sec_pls_mm,
                        structural_model = sec_pls_sm)

plot(sec_pls)
```

### ii

Weights and loadings of composites

```{r, results="hold"}
# Weights
sec_pls_report <- summary(sec_pls)
sec_pls_report$weights
```

```{r, results="hold"}
# Loadings of composites
sec_pls_report$loadings
```

### iii

Regression coefficients of paths between factors

```{r, results="hold"}
sec_pls_report$paths
```

### iv

Bootstrapped path coefficients: t-values, 95% CI

```{r, results="hold"}
boot_pls <- bootstrap_model(sec_pls, nboot = 1000)
summary(boot_pls)
```

# Question 2

Common-Factor Models using CB-SEM

## 2a

Create a common factor model using SEMinR, with the following characteristics:

### i

Either respecify all the constructs as being reflective(), or use the as.reflective() function to convert your earlier measurement model to being entirely reflective.

```{r, results="hold"}
sec_cbsem_mm <- constructs(
  reflective("TRUST", multi_items("TRST",1:4)), # Trust in website (TRUST)
  reflective("SEC", multi_items("PSEC",1:4)), # Perceived security of website (SEC)
  reflective("REP", multi_items("PREP",1:4)), # Reputation of website (REP)
  reflective("INV", multi_items("PINV",1:3)), # Investment in website (INV)
  reflective("POL", multi_items("PPSS",1:3)), # Perception of privacy policies (POL)
  reflective("FAML", single_item("FAML1")), # Familiarity with website (FAML)
  interaction_term(iv = "REP", moderator = "POL", method=orthogonal)
)
```

### ii

Use the same structural model as before

```{r, results="hold"}
# REP + INV + POL + FAML + (REP✕POL) → SEC → TRUST
sec_cbsem_sm <- relationships(
  paths(from = c("REP","INV","POL","FAML","REP*POL"), to = "SEC"),
  paths(from = "SEC", to = "TRUST")
)
```

## 2b

Show us the following results in table or figure formats

### i

Plot a figure of the estimated model (it will look different from your PLS model!)

```{r, results="hold"}
sec_cbsem <- estimate_cbsem(data = sec,
                        measurement_model = sec_cbsem_mm,
                        structural_model = sec_cbsem_sm)

plot(sec_cbsem)
```

### ii

Loadings of composites

```{r, results="hold"}
sec_cbsem_report <- summary(sec_cbsem)
sec_cbsem_report$loadings
```

### iii

Regression coefficients of paths between factors, and their p-values

```{r, results="hold"}
sec_cbsem_report$paths
```
