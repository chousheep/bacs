---
title: "bacs_hw4"
author: '110071010'
date: "2024-03-14"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Question 1

The large American phone company Verizon had a monopoly on phone services in many areas of the US. The New York Public Utilities Commission (PUC) regularly monitors repair times with customers in New York to verify the quality of Verizon’s services. The file verizon.csv has a recent sample of repair times collected by the PUC.

## 1a

Imagine that Verizon claims that they take 7.6 minutes to repair phone services for its customers on average. The PUC seeks to verify this claim at 99% confidence using traditional statistical methods.

### (i) Visualize the distribution of Verizon’s repair times, marking the mean with a vertical line

```{r}
verizon <- read.csv('verizon.csv')
sample_verizonrt <- verizon$Time
plot(density(sample_verizonrt),main = "Distribution of Verizon's Repair Times", col="blue",lwd=2)
abline(v=mean(sample_verizonrt), lwd=2)
```

### (ii) Given what the PUC wishes to test, how would you write the hypothesis ?

Null Hypothesis H0: μ = 7.6 mins

Alternative Hypothesis H1: μ ≠ 7.6 mins

### (iii) Estimate the population mean, and the 99% confidence interval (CI) of this estimate

```{r}
sample_size <- length(sample_verizonrt)
sample_mean <- mean(sample_verizonrt)
standard_error <- sample_mean/sqrt(sample_size)

ci99 <- sample_mean + c(-2.58*se, 2.58*se) 

cat("Sample Mean:", sample_mean, "\n")
cat("Standard Error:", standard_error, "\n")
cat("99% Confidence Interval of the Sampling Means:", 
    "\n","Lower Bound =", ci99[1], "\n",
    "Upper Bound =", ci99[2], "\n")
```

### (iv) Find the t-statistic and p-value of the test

```{r}
hyp_mean <- 7.6
t <- (sample_mean - hyp_mean)/standard_error
df <- sample_size - 1

p <- 1 - pt(t,df)
pt(t,df)
```

```{r}
t.test(x = sample_verizonrt, mu = 7.6, conf.level = 0.99)
```

### 
(v) Briefly describe how these values relate to the Null distribution of t 

### (vi) What is your conclusion about the company’s claim from this t-statistic, and why?

P_value \> 0.01. Reject Null Hypothesis that mu = 7.6

## 1b

### (i) Bootstrapped Percentile: Estimate the bootstrapped 99% CI of the population mean

```{r}
set.seed(123123)

num_boot <- 2000

sample_statistic <- function(stat_function, sample0){
  resample <-sample(sample0,length(sample0),replace=TRUE)
  stat_function(resample)
}
boot_sample_means <- replicate(num_boot,sample_statistic(mean,sample))
plot(density(boot_sample_means),lwd=2, main="Bootstrapped Sample Means")
quantile(boot_sample_means, probs = c(0.005,0.995))
```

### 
(ii) Bootstrapped Difference of Means: What is the 99% CI of the bootstrapped difference between the sample mean and the hypothesized mean?

### 
(iii) Bootstrapped t-statistic: What is the 99% CI of the bootstrapped t-statistic of the sample mean versus the hypothesized mean?

### 
(iv) Plot the distribution of the three bootstraps above on separate plots; draw vertical lines showing the lower/upper bounds of their respective 99% confidence intervals.

### 
(v) Does the bootstrapped approach agree with the traditional t-test in part [a]?

# Question 2
